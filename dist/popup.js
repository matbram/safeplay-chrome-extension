(()=>{"use strict";const e={enabled:!0,filterMode:"mute",severityLevels:{mild:!1,moderate:!0,severe:!0,religious:!1},customBlacklist:[],customWhitelist:[],paddingMs:50,paddingBeforeMs:100,paddingAfterMs:30,mergeThresholdMs:100,autoEnableForFilteredVideos:!0},t=[{word:"jesus",severity:"religious"},{word:"jesus christ",severity:"religious"},{word:"jesus fucking christ",severity:"religious"},{word:"christ",severity:"religious"},{word:"christ almighty",severity:"religious"},{word:"god",severity:"religious"},{word:"oh my god",severity:"religious"},{word:"omg",severity:"religious"},{word:"oh god",severity:"religious"},{word:"my god",severity:"religious"},{word:"for gods sake",severity:"religious"},{word:"for god's sake",severity:"religious"},{word:"god almighty",severity:"religious"},{word:"swear to god",severity:"religious"},{word:"i swear to god",severity:"religious"},{word:"goddamn",severity:"religious"},{word:"goddamned",severity:"religious"},{word:"goddamnit",severity:"religious"},{word:"goddammit",severity:"religious"},{word:"goddamit",severity:"religious"},{word:"goddam",severity:"religious"},{word:"goddams",severity:"religious"},{word:"god damn",severity:"religious"},{word:"god damned",severity:"religious"},{word:"god damnit",severity:"religious"},{word:"god dammit",severity:"religious"},{word:"god damn it",severity:"religious"},{word:"god-damn",severity:"religious"},{word:"god-damned",severity:"religious"},{word:"god-damnit",severity:"religious"},{word:"god-dammit",severity:"religious"},{word:"godd*mn",severity:"religious"},{word:"g*ddamn",severity:"religious"},{word:"gd",severity:"religious"},{word:"gdamn",severity:"religious"},{word:"gotdamn",severity:"religious"},{word:"gotdam",severity:"religious"},{word:"got damn",severity:"religious"},{word:"got dam",severity:"religious"},{word:"gahdamn",severity:"religious"},{word:"gawddamn",severity:"religious"},{word:"gahdam",severity:"religious"},{word:"lord",severity:"religious"},{word:"oh lord",severity:"religious"},{word:"dear lord",severity:"religious"},{word:"good lord",severity:"religious"},{word:"lord almighty",severity:"religious"},{word:"lord have mercy",severity:"religious"},{word:"lordy",severity:"religious"},{word:"lawdy",severity:"religious"},{word:"lawd",severity:"religious"},{word:"oh lawd",severity:"religious"},{word:"holy",severity:"religious"},{word:"holy shit",severity:"religious"},{word:"holy crap",severity:"religious"},{word:"holy hell",severity:"religious"},{word:"holy fuck",severity:"religious"},{word:"holy cow",severity:"religious"},{word:"holy smokes",severity:"religious"},{word:"holy moly",severity:"religious"},{word:"holy mother",severity:"religious"},{word:"holy mother of god",severity:"religious"},{word:"for christ's sake",severity:"religious"},{word:"for christs sake",severity:"religious"},{word:"chrissake",severity:"religious"},{word:"crissake",severity:"religious"},{word:"fuck",severity:"severe"},{word:"fucking",severity:"severe"},{word:"fucked",severity:"severe"},{word:"fucker",severity:"severe"},{word:"fuckers",severity:"severe"},{word:"fucks",severity:"severe"},{word:"motherfucker",severity:"severe"},{word:"motherfucking",severity:"severe"},{word:"motherfuckers",severity:"severe"},{word:"cunt",severity:"severe"},{word:"cunts",severity:"severe"},{word:"nigger",severity:"severe"},{word:"niggers",severity:"severe"},{word:"nigga",severity:"severe"},{word:"niggas",severity:"severe"},{word:"faggot",severity:"severe"},{word:"faggots",severity:"severe"},{word:"fag",severity:"severe"},{word:"fags",severity:"severe"},{word:"retard",severity:"severe"},{word:"retarded",severity:"severe"},{word:"retards",severity:"severe"},{word:"shit",severity:"moderate"},{word:"shits",severity:"moderate"},{word:"shitty",severity:"moderate"},{word:"bullshit",severity:"moderate"},{word:"horseshit",severity:"moderate"},{word:"shithead",severity:"moderate"},{word:"shitheads",severity:"moderate"},{word:"ass",severity:"moderate"},{word:"asses",severity:"moderate"},{word:"asshole",severity:"moderate"},{word:"assholes",severity:"moderate"},{word:"bastard",severity:"moderate"},{word:"bastards",severity:"moderate"},{word:"bitch",severity:"moderate"},{word:"bitches",severity:"moderate"},{word:"bitchy",severity:"moderate"},{word:"cock",severity:"moderate"},{word:"cocks",severity:"moderate"},{word:"cocksucker",severity:"moderate"},{word:"cocksuckers",severity:"moderate"},{word:"dick",severity:"moderate"},{word:"dicks",severity:"moderate"},{word:"dickhead",severity:"moderate"},{word:"dickheads",severity:"moderate"},{word:"pussy",severity:"moderate"},{word:"pussies",severity:"moderate"},{word:"prick",severity:"moderate"},{word:"pricks",severity:"moderate"},{word:"slut",severity:"moderate"},{word:"sluts",severity:"moderate"},{word:"slutty",severity:"moderate"},{word:"whore",severity:"moderate"},{word:"whores",severity:"moderate"},{word:"twat",severity:"moderate"},{word:"twats",severity:"moderate"},{word:"wanker",severity:"moderate"},{word:"wankers",severity:"moderate"},{word:"bollocks",severity:"moderate"},{word:"damn",severity:"mild"},{word:"damned",severity:"mild"},{word:"dammit",severity:"mild"},{word:"damnit",severity:"mild"},{word:"hell",severity:"mild"},{word:"crap",severity:"mild"},{word:"crappy",severity:"mild"},{word:"piss",severity:"mild"},{word:"pissed",severity:"mild"},{word:"pissing",severity:"mild"},{word:"suck",severity:"mild"},{word:"sucks",severity:"mild"},{word:"sucked",severity:"mild"},{word:"balls",severity:"mild"},{word:"butt",severity:"mild"},{word:"butthole",severity:"mild"},{word:"screw",severity:"mild"},{word:"screwed",severity:"mild"},{word:"douche",severity:"mild"},{word:"douchebag",severity:"mild"},{word:"douchebags",severity:"mild"}];new Map(t.map(e=>[e.word.toLowerCase(),e.severity])),new Set(["class","classes","classic","classical","classics","classify","classified","classification","classmate","classmates","classroom","classrooms","classy","grass","grassy","grassland","grasshopper","pass","passed","passes","passing","passable","passage","passages","passenger","passengers","passport","passports","password","passwords","bypass","bypassed","bypasses","bypassing","compass","compasses","bass","bassist","bassline","mass","masses","massive","massively","massacre","brass","brassy","glass","glasses","glassy","glassware","sass","sassy","sassafras","lass","lassie","lasso","cassette","cassettes","casserole","assassin","assassins","assassinate","assassination","embassy","embassies","ambassador","ambassadors","harass","harassed","harassing","harassment","amass","amassed","amassing","morass","trespass","trespassed","trespassing","trespasser","carcass","carcasses","canvas","canvases","canvass","canvassed","molasses","assume","assumed","assumes","assuming","assumption","assumptions","assure","assured","assures","assuring","assurance","assess","assessed","assesses","assessing","assessment","assessments","asset","assets","assign","assigned","assigns","assigning","assignment","assignments","assist","assisted","assists","assisting","assistant","assistants","assistance","associate","associated","associates","associating","association","associations","assort","assorted","assortment","hello","hellos","shell","shells","shelled","shelling","shellfish","bombshell","nutshell","eggshell","seashell","clamshell","dwell","dwells","dwelled","dwelling","dwellings","swell","swells","swelled","swelling","swollen","well","wells","wellness","farewell","stairwell","spell","spells","spelled","spelling","misspell","misspelled","smell","smells","smelled","smelling","smelly","bell","bells","doorbell","bellhop","bluebell","dumbbell","barbell","cell","cells","cellular","cellar","cellars","fell","fella","fellas","fellow","fellows","fellowship","jell","jelly","jellyfish","tell","tells","telling","teller","storytelling","foretell","sell","sells","selling","seller","sellers","bestseller","bestselling","yell","yells","yelled","yelling","propel","propelled","propeller","propelling","excel","excels","excelled","excelling","excellent","excellence","expel","expels","expelled","expelling","compel","compels","compelled","compelling","repel","repels","repelled","repelling","repellent","rebellion","rebellious","rebel","rebels","rebelled","hellenic","hellenistic","amsterdam","macadam","madame","madam","peacock","peacocks","cockpit","cockpits","cocktail","cocktails","cockatoo","cockatoos","cockerel","hancock","hitchcock","babcock","woodcock","stopcock","weathercock","dickens","benedict","benediction","predict","predicts","predicted","predicting","prediction","predictions","addict","addicts","addicted","addicting","addiction","addictions","addictive","verdict","verdicts","indict","indicts","indicted","indicting","indictment","contradict","contradicts","contradicted","contradicting","contradiction","dictionary","dictionaries","diction","dictate","dictates","dictated","dictating","dictation","dictator","edict","edicts","jurisdiction","scrap","scraps","scrapped","scrapping","scrappy","scrapbook","scrapyard","mississippi","title","titles","titled","titling","subtitle","subtitles","subtitled","entitle","entitled","entitles","entitling","entitlement","constitution","constitutional","constitutions","institution","institutional","institutions","restitution","stitute","substitute","substitutes","substituted","substitution","institute","institutes","instituted","institution","prostitute","prostitutes","prostitution","titan","titans","titanic","appetite","appetites","appetizer","appetizers","competition","competitions","competitive","competitor","competitors","petition","petitions","petitioned","petitioning","repetition","repetitions","repetitive","partition","partitions","partitioned","quantity","quantities","quantitative","identity","identities","entity","entities","utility","utilities","fertility","infertility","document","documents","documented","documenting","documentation","documentary","circumstance","circumstances","circumstantial","circumference","accumulate","accumulated","accumulates","accumulating","accumulation","cucumber","cucumbers","incumbent","succumb","succumbed","succumbing","faggot","sextant","sextet","sextuple","shoe","shoes","shoed","shoeing","horseshoe","hoe","hoes","hoeing","whole","wholesome","wholesale","wholly","honest","honestly","honesty","dishonest","honor","honors","honored","honoring","honorable","honorary","dishonor","hope","hopes","hoped","hoping","hopeful","hopefully","hopeless","home","homes","homed","homing","homeless","homemade","hometown","homework","horse","horses","horseback","horsepower","hotel","hotels","horizon","horizons","horizontal","hour","hours","hourly","house","houses","housed","housing","household","housewife","housekeeper","night","nights","nightly","nighttime","nightmare","nightmares","nightclub","tonight","overnight","midnight","goodnight","fortnight","knight","knights","knighthood","ignite","ignites","ignited","igniting","ignition","insignificant","significance","significant","significantly","nude","nudes","nudity","analog","analogue","analogous","analogy","analogies","analysis","analyses","analyst","analysts","analytical","analyze","analyzed","banal","canal","canals","final","finals","finally","finalist","finalize","finalized","journal","journals","journalism","journalist","journalists","national","nationally","international","internationally","personal","personally","personality","personalities","professional","professionally","professionals","regional","regionally","original","originally","originals","criminal","criminally","criminals","terminal","terminals","cardinal","cardinals","signal","signals","signaled","signaling","minute","minutes","minutely","peanut","peanuts","coconut","coconuts","chestnut","chestnuts","walnut","walnuts","doughnut","doughnuts","donut","donuts","nutmeg","nutrition","nutritious","nutritional","nutrient","nutrients","godfather","godfathers","godmother","godmothers","godchild","godchildren","godson","godsons","goddaughter","goddaughters","godly","godliness","ungodly","goddess","goddesses","godspeed","godsend","landlord","landlords","landlady","warlord","warlords","overlord","overlords","lordship","holiday","holidays","wholly","christen","christened","christening","christian","christians","christianity","christmas","christmastime","christopher","hellfire","hellbound"]);const s="safeplay_theme";class i{constructor(){this.preferences=e,this.creditInfo=null,this.authState=null,this.wordCounts={mild:0,moderate:0,severe:0,religious:0}}async initialize(){this.calculateWordCounts(),this.cacheElements(),this.loadTheme(),this.displayWordCounts(),await this.loadPreferences(),this.setupEventListeners(),await this.checkVideoStatus(),await this.loadAuthState(),this.setupMessageListener()}cacheElements(){this.themeToggle=document.getElementById("themeToggle"),this.enableToggle=document.getElementById("enableToggle"),this.filterModeRadios=document.querySelectorAll('input[name="filterMode"]'),this.severityMild=document.getElementById("severityMild"),this.severityModerate=document.getElementById("severityModerate"),this.severitySevere=document.getElementById("severitySevere"),this.severityReligious=document.getElementById("severityReligious"),this.statusPill=document.getElementById("statusPill"),this.statusLabel=document.getElementById("statusLabel"),this.videoStatusSection=document.getElementById("videoStatus"),this.videoStatusValue=document.getElementById("videoStatusValue"),this.filteredCount=document.getElementById("filteredCount"),this.progressBar=document.getElementById("progressBar"),this.progressFill=document.getElementById("progressFill"),this.totalWordCount=document.getElementById("totalWordCount"),this.mildCount=document.getElementById("mildCount"),this.moderateCount=document.getElementById("moderateCount"),this.severeCount=document.getElementById("severeCount"),this.religiousCount=document.getElementById("religiousCount"),this.accountLoggedOut=document.getElementById("accountLoggedOut"),this.accountLoggedIn=document.getElementById("accountLoggedIn"),this.signInBtn=document.getElementById("signInBtn"),this.signOutBtn=document.getElementById("signOutBtn"),this.accountAvatar=document.getElementById("accountAvatar"),this.accountName=document.getElementById("accountName"),this.accountPlanBadge=document.getElementById("accountPlanBadge"),this.accountUpgradeLink=document.getElementById("accountUpgradeLink"),this.creditValue=document.getElementById("creditValue")}loadTheme(){"light"===localStorage.getItem(s)&&document.body.classList.add("light-theme")}toggleTheme(){const e=document.body.classList.toggle("light-theme");localStorage.setItem(s,e?"light":"dark")}async loadCredits(){if(this.authState?.isAuthenticated)try{const e=await chrome.runtime.sendMessage({type:"GET_CREDITS"});e.success&&e.data&&(this.creditInfo=e.data,this.displayCredits())}catch(e){console.error("Failed to load credits:",e)}else this.creditValue.textContent="0"}displayCredits(){if(!this.creditInfo)return;const{available:e,used_this_period:t,plan_allocation:s}=this.creditInfo;this.creditValue.textContent=e.toString(),this.creditValue.classList.remove("low","empty");const i=Math.max(0,s-t),r=Math.max(0,e-i);0===e?this.creditValue.classList.add("empty"):0===i&&r<=5&&this.creditValue.classList.add("low")}calculateWordCounts(){for(const e of t)this.wordCounts[e.severity]++}displayWordCounts(){this.mildCount.textContent=this.wordCounts.mild.toString(),this.moderateCount.textContent=this.wordCounts.moderate.toString(),this.severeCount.textContent=this.wordCounts.severe.toString(),this.religiousCount.textContent=this.wordCounts.religious.toString(),this.updateTotalWordCount()}updateTotalWordCount(){let e=0;this.severityMild?.checked&&(e+=this.wordCounts.mild),this.severityModerate?.checked&&(e+=this.wordCounts.moderate),this.severitySevere?.checked&&(e+=this.wordCounts.severe),this.severityReligious?.checked&&(e+=this.wordCounts.religious),e+=this.preferences.customBlacklist.length,this.totalWordCount.textContent=`${e} words`}async loadPreferences(){try{const e=await chrome.runtime.sendMessage({type:"GET_PREFERENCES"});e.success&&e.data&&(this.preferences=e.data,this.updateUI())}catch(e){console.error("Failed to load preferences:",e)}}updateUI(){this.enableToggle.checked=this.preferences.enabled,document.body.classList.toggle("disabled",!this.preferences.enabled),this.updateStatusPill(),this.filterModeRadios.forEach(e=>{e.checked=e.value===this.preferences.filterMode}),this.severityMild.checked=this.preferences.severityLevels.mild,this.severityModerate.checked=this.preferences.severityLevels.moderate,this.severitySevere.checked=this.preferences.severityLevels.severe,this.severityReligious.checked=this.preferences.severityLevels.religious,this.updateTotalWordCount()}updateStatusPill(){this.statusPill.classList.remove("inactive","error","warning"),this.preferences.enabled?this.statusLabel.textContent="Active":(this.statusPill.classList.add("inactive"),this.statusLabel.textContent="Disabled")}setupEventListeners(){this.themeToggle.addEventListener("click",()=>{this.toggleTheme()}),this.enableToggle.addEventListener("change",()=>{this.savePreferences({enabled:this.enableToggle.checked})}),this.filterModeRadios.forEach(e=>{e.addEventListener("change",()=>{e.checked&&this.savePreferences({filterMode:e.value})})});const e=()=>{this.saveSeverityLevels(),this.updateTotalWordCount()};this.severityMild.addEventListener("change",e),this.severityModerate.addEventListener("change",e),this.severitySevere.addEventListener("change",e),this.severityReligious.addEventListener("change",e),this.signInBtn?.addEventListener("click",()=>this.handleSignIn()),this.signOutBtn?.addEventListener("click",()=>this.handleSignOut());const t=document.getElementById("settingsLink");t?.addEventListener("click",e=>{e.preventDefault(),chrome.runtime.openOptionsPage?.()})}saveSeverityLevels(){this.savePreferences({severityLevels:{mild:this.severityMild.checked,moderate:this.severityModerate.checked,severe:this.severitySevere.checked,religious:this.severityReligious.checked}})}async savePreferences(e){try{const t=await chrome.runtime.sendMessage({type:"SET_PREFERENCES",payload:e});t.success&&t.data&&(this.preferences=t.data,this.updateUI())}catch(e){console.error("Failed to save preferences:",e)}}async checkVideoStatus(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!e?.id||!e.url?.includes("youtube.com/watch"))return void(this.videoStatusSection.style.display="none");const t=await chrome.tabs.sendMessage(e.id,{type:"GET_VIDEO_STATE"});t?.success&&t.data&&this.updateVideoStatus(t.data)}catch(e){this.videoStatusSection.style.display="none"}}updateVideoStatus(e){this.videoStatusSection.style.display="block",this.videoStatusValue.textContent={idle:"Ready",loading:"Loading",processing:"Processing",active:"Filtering",error:"Error",disabled:"Disabled","age-restricted":"Restricted"}[e.status]||e.status,this.statusPill.classList.remove("error","warning"),"age-restricted"===e.status?(this.statusPill.classList.add("warning"),this.statusLabel.textContent="Restricted"):"error"===e.status&&(this.statusPill.classList.add("error"),this.statusLabel.textContent="Error"),this.filteredCount.textContent=e.intervalCount.toString(),"processing"===e.status?(this.progressBar.style.display="block",this.progressFill.style.width=`${e.progress}%`):this.progressBar.style.display="none"}setupMessageListener(){chrome.runtime.onMessage.addListener(e=>{"VIDEO_STATE_CHANGED"===e.type&&e.payload&&this.updateVideoStatus(e.payload),"PREFERENCES_UPDATED"===e.type&&e.payload&&(this.preferences=e.payload,this.updateUI()),"CREDIT_UPDATE"===e.type&&e.payload&&(this.creditInfo=e.payload,this.displayCredits()),"AUTH_STATE_CHANGED"===e.type&&e.payload&&this.loadAuthState()})}async loadAuthState(){try{const e=await chrome.runtime.sendMessage({type:"GET_USER_PROFILE"});e.success&&e.data?(this.authState=e.data,this.updateAccountUI(),this.authState?.isAuthenticated&&await this.loadCredits()):(this.authState={isAuthenticated:!1,user:null,subscription:null,credits:null,token:null},this.updateAccountUI())}catch(e){console.error("Failed to load auth state:",e),this.authState={isAuthenticated:!1,user:null,subscription:null,credits:null,token:null},this.updateAccountUI()}}updateAccountUI(){if(this.authState)if(this.authState.isAuthenticated&&this.authState.user){this.accountLoggedOut.style.display="none",this.accountLoggedIn.style.display="flex";const e=this.authState.user;this.accountName.textContent=e.full_name||e.email?.split("@")[0]||"User",e.avatar_url?this.accountAvatar.innerHTML=`<img src="${this.escapeHtml(e.avatar_url)}" alt="Avatar">`:this.accountAvatar.innerHTML='\n          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>\n            <circle cx="12" cy="7" r="4"/>\n          </svg>\n        ';const t=this.authState.subscription,s=t?.plans?.name||"Free",i=s.toLowerCase();this.accountPlanBadge.textContent=s,this.accountPlanBadge.className=`account-plan ${i}`,this.accountUpgradeLink.style.display="unlimited"===i||"organization"===i?"none":"flex"}else this.accountLoggedOut.style.display="flex",this.accountLoggedIn.style.display="none",this.creditValue.textContent="0"}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async handleSignIn(){try{await chrome.runtime.sendMessage({type:"OPEN_LOGIN"}),window.close()}catch(e){console.error("Failed to open login:",e)}}async handleSignOut(){try{await chrome.runtime.sendMessage({type:"LOGOUT"}),this.authState={isAuthenticated:!1,user:null,subscription:null,credits:null,token:null},this.creditInfo=null,this.updateAccountUI()}catch(e){console.error("Failed to sign out:",e)}}}document.addEventListener("DOMContentLoaded",()=>{(new i).initialize()})})();
//# sourceMappingURL=popup.js.map