{"version":3,"file":"popup.js","mappings":"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","sources":["webpack://safeplay-chrome-extension/./src/types/index.ts","webpack://safeplay-chrome-extension/./src/filter/profanity-list.ts","webpack://safeplay-chrome-extension/./src/popup/index.ts"],"sourcesContent":["// API Response Types\n\nexport interface CharacterTiming {\n  char: string;\n  start: number;\n  end: number;\n}\n\nexport interface TranscriptSegment {\n  text: string;\n  start_time: number;\n  end_time: number;\n  characters: CharacterTiming[];\n}\n\nexport interface Transcript {\n  id: string;\n  youtube_id?: string; // May be set from context\n  full_text?: string;\n  segments: TranscriptSegment[];\n  duration?: number;\n  language?: string;\n  created_at?: string;\n}\n\n// Video metadata from preview endpoint\nexport interface VideoMetadata {\n  youtube_id: string;\n  title: string;\n  duration: number; // in seconds\n  thumbnail?: string;\n  channel?: string;\n}\n\n// Credit system types\nexport interface CreditInfo {\n  available: number;\n  used_this_period: number;\n  plan_allocation: number;\n  percent_consumed: number;\n  plan?: 'free' | 'base' | 'professional' | 'unlimited';\n  reset_date?: string;\n}\n\n// Preview response - check cost before filtering (matches actual API format)\nexport interface PreviewResponse {\n  youtube_id: string;\n  title: string;\n  channel_name?: string;\n  duration_seconds: number;\n  thumbnail_url?: string;\n  credit_cost: number;\n  user_credits: number;\n  has_sufficient_credits: boolean;\n  cached: boolean;\n  has_transcript: boolean;\n  credit_cost_note?: string; // Note when duration/cost is unknown\n  error?: string;\n  error_code?: 'AGE_RESTRICTED' | 'VIDEO_UNAVAILABLE' | 'UNAUTHORIZED' | string;\n}\n\n// Credit balance response\nexport interface CreditBalanceResponse {\n  success: boolean;\n  credits: CreditInfo;\n  error?: string;\n}\n\n// Filter start response\nexport interface FilterStartResponse {\n  success: boolean;\n  status: 'completed' | 'processing' | 'failed';\n  cached?: boolean;\n  transcript?: Transcript;\n  job_id?: string;\n  message?: string;\n  error?: string;\n  error_code?: 'INSUFFICIENT_CREDITS' | 'AGE_RESTRICTED' | 'VIDEO_UNAVAILABLE' | 'UNAUTHORIZED' | string;\n  credits_required?: number;\n  credits_available?: number;\n}\n\n// Job status response\nexport interface JobStatusResponse {\n  status: 'pending' | 'downloading' | 'transcribing' | 'completed' | 'failed';\n  progress: number;\n  message?: string;\n  transcript?: Transcript;\n  error?: string;\n  error_code?: 'AGE_RESTRICTED' | 'VIDEO_UNAVAILABLE' | string;\n  video?: {\n    youtube_id: string;\n    title?: string;\n  };\n}\n\n// Legacy FilterResponse - kept for compatibility during migration\nexport interface FilterResponse {\n  status: 'completed' | 'processing' | 'failed';\n  cached?: boolean;\n  transcript?: Transcript;\n  job_id?: string;\n  message?: string;\n  error?: string;\n  error_code?: string;  // 'AGE_RESTRICTED', 'VIDEO_UNAVAILABLE', etc.\n}\n\n// Button state for UX\nexport type ButtonState =\n  | 'idle'\n  | 'connecting'\n  | 'downloading'\n  | 'transcribing'\n  | 'processing'\n  | 'filtering'\n  | 'paused'  // Filter is paused (user can re-enable)\n  | 'error'\n  | 'age-restricted';  // Video is age-restricted and cannot be filtered\n\nexport interface ButtonStateInfo {\n  state: ButtonState;\n  text: string;\n  progress?: number;\n  intervalCount?: number;\n  error?: string;\n  videoId?: string; // Track which video this state belongs to (for Shorts)\n}\n\n// Profanity Types\n\nexport type SeverityLevel = 'mild' | 'moderate' | 'severe' | 'religious';\n\nexport interface ProfanityWord {\n  word: string;\n  severity: SeverityLevel;\n}\n\nexport interface MuteInterval {\n  start: number;\n  end: number;\n  word: string;\n  severity: SeverityLevel;\n}\n\nexport interface ProfanityMatch {\n  segmentIndex: number;\n  word: string;\n  severity: SeverityLevel;\n  startTime: number;\n  endTime: number;\n  isPartialMatch: boolean;\n  matchedPortion?: string;\n}\n\n// User Preferences\n\nexport type FilterMode = 'mute' | 'bleep';\n\nexport interface UserPreferences {\n  enabled: boolean;\n  filterMode: FilterMode;\n  severityLevels: {\n    mild: boolean;\n    moderate: boolean;\n    severe: boolean;\n    religious: boolean;\n  };\n  customBlacklist: string[];\n  customWhitelist: string[];\n  paddingMs: number; // Legacy/fallback symmetric padding\n  paddingBeforeMs?: number; // Padding before word starts (catches attack)\n  paddingAfterMs?: number; // Padding after word ends (catches release)\n  mergeThresholdMs: number;\n  autoEnableForFilteredVideos: boolean; // Auto-enable filter for previously filtered videos\n}\n\nexport const DEFAULT_PREFERENCES: UserPreferences = {\n  enabled: true,\n  filterMode: 'mute',\n  severityLevels: {\n    mild: false,\n    moderate: true,\n    severe: true,\n    religious: false, // Off by default - user opt-in\n  },\n  customBlacklist: [],\n  customWhitelist: [],\n  paddingMs: 50, // Legacy/fallback symmetric padding\n  paddingBeforeMs: 100, // Padding before word - smooth fade adds ~130ms effective lead time\n  paddingAfterMs: 30, // Padding after word ends\n  mergeThresholdMs: 100,\n  autoEnableForFilteredVideos: true, // Auto-enable filter for previously filtered videos\n};\n\n// Storage Types\n\nexport type SubscriptionTier = 'free' | 'base' | 'professional' | 'unlimited';\n\nexport interface StorageData {\n  preferences: UserPreferences;\n  authToken?: string;\n  userId?: string;\n  subscriptionTier?: SubscriptionTier;\n  creditInfo?: CreditInfo;\n  cachedTranscripts: Record<string, Transcript>;\n}\n\n// Message Types (between content script and background)\n\nexport type MessageType =\n  | 'GET_FILTER'\n  | 'GET_PREVIEW'\n  | 'START_FILTER'\n  | 'CHECK_JOB'\n  | 'GET_CREDITS'\n  | 'GET_PREFERENCES'\n  | 'SET_PREFERENCES'\n  | 'GET_AUTH_STATUS'\n  | 'GET_USER_PROFILE'\n  | 'LOGOUT'\n  | 'OPEN_LOGIN'\n  | 'CLEAR_CACHE';\n\nexport interface Message<T = unknown> {\n  type: MessageType;\n  payload?: T;\n}\n\nexport interface MessageResponse<T = unknown> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n// Preview data passed to content script\nexport interface PreviewData {\n  video: VideoMetadata;\n  creditCost: number;\n  creditCostNote?: string; // Note when cost is unknown (e.g., \"~1 credit per minute\")\n  creditCostUnknown?: boolean; // True when duration unavailable\n  userCredits: number;\n  hasSufficientCredits: boolean;\n  isCached: boolean;\n}\n\n// Filter confirmation payload from content script\nexport interface FilterConfirmPayload {\n  youtubeId: string;\n  filterType?: 'mute' | 'bleep';\n  customWords?: string[];\n}\n\n// User Profile Types\nexport interface UserProfile {\n  id: string;\n  email: string;\n  full_name?: string;\n  avatar_url?: string;\n  created_at?: string;\n}\n\nexport interface UserSubscription {\n  id: string;\n  user_id: string;\n  plan_id: string;\n  status: 'active' | 'canceled' | 'past_due' | 'paused';\n  current_period_start?: string;\n  current_period_end?: string;\n  plans?: {\n    id: string;\n    name: string;\n    monthly_credits: number;\n  };\n}\n\nexport interface UserCredits {\n  user_id: string;\n  available_credits: number;\n  used_this_period: number;\n  rollover_credits: number;\n  updated_at?: string;\n}\n\nexport interface UserProfileResponse {\n  user: UserProfile;\n  subscription: UserSubscription | null;\n  credits: UserCredits | null;\n}\n\nexport interface AuthState {\n  isAuthenticated: boolean;\n  user: UserProfile | null;\n  subscription: UserSubscription | null;\n  credits: UserCredits | null;\n  token: string | null;\n}\n","import { ProfanityWord, SeverityLevel } from '../types';\n\n// Comprehensive profanity list with severity levels\n// Severity: mild (common/casual), moderate (offensive), severe (highly offensive), religious (religious terms)\n\nexport const PROFANITY_LIST: ProfanityWord[] = [\n  // Religious - opt-in category for religious terms some users may want filtered\n  { word: 'jesus', severity: 'religious' },\n  { word: 'jesus christ', severity: 'religious' },\n  { word: 'jesus fucking christ', severity: 'religious' },\n  { word: 'christ', severity: 'religious' },\n  { word: 'christ almighty', severity: 'religious' },\n  { word: 'god', severity: 'religious' },\n  { word: 'oh my god', severity: 'religious' },\n  { word: 'omg', severity: 'religious' },\n  { word: 'oh god', severity: 'religious' },\n  { word: 'my god', severity: 'religious' },\n  { word: 'for gods sake', severity: 'religious' },\n  { word: 'for god\\'s sake', severity: 'religious' },\n  { word: 'god almighty', severity: 'religious' },\n  { word: 'swear to god', severity: 'religious' },\n  { word: 'i swear to god', severity: 'religious' },\n\n  // Goddamn variations - all spellings and spacings\n  { word: 'goddamn', severity: 'religious' },\n  { word: 'goddamned', severity: 'religious' },\n  { word: 'goddamnit', severity: 'religious' },\n  { word: 'goddammit', severity: 'religious' },\n  { word: 'goddamit', severity: 'religious' },\n  { word: 'goddam', severity: 'religious' },\n  { word: 'goddams', severity: 'religious' },\n  { word: 'god damn', severity: 'religious' },\n  { word: 'god damned', severity: 'religious' },\n  { word: 'god damnit', severity: 'religious' },\n  { word: 'god dammit', severity: 'religious' },\n  { word: 'god damn it', severity: 'religious' },\n  { word: 'god-damn', severity: 'religious' },\n  { word: 'god-damned', severity: 'religious' },\n  { word: 'god-damnit', severity: 'religious' },\n  { word: 'god-dammit', severity: 'religious' },\n  { word: 'godd*mn', severity: 'religious' },\n  { word: 'g*ddamn', severity: 'religious' },\n  { word: 'gd', severity: 'religious' },\n  { word: 'gdamn', severity: 'religious' },\n  { word: 'gotdamn', severity: 'religious' },\n  { word: 'gotdam', severity: 'religious' },\n  { word: 'got damn', severity: 'religious' },\n  { word: 'got dam', severity: 'religious' },\n  { word: 'gahdamn', severity: 'religious' },\n  { word: 'gawddamn', severity: 'religious' },\n  { word: 'gahdam', severity: 'religious' },\n\n  // Lord variations\n  { word: 'lord', severity: 'religious' },\n  { word: 'oh lord', severity: 'religious' },\n  { word: 'dear lord', severity: 'religious' },\n  { word: 'good lord', severity: 'religious' },\n  { word: 'lord almighty', severity: 'religious' },\n  { word: 'lord have mercy', severity: 'religious' },\n  { word: 'lordy', severity: 'religious' },\n  { word: 'lawdy', severity: 'religious' },\n  { word: 'lawd', severity: 'religious' },\n  { word: 'oh lawd', severity: 'religious' },\n\n  // Holy variations\n  { word: 'holy', severity: 'religious' },\n  { word: 'holy shit', severity: 'religious' },\n  { word: 'holy crap', severity: 'religious' },\n  { word: 'holy hell', severity: 'religious' },\n  { word: 'holy fuck', severity: 'religious' },\n  { word: 'holy cow', severity: 'religious' },\n  { word: 'holy smokes', severity: 'religious' },\n  { word: 'holy moly', severity: 'religious' },\n  { word: 'holy mother', severity: 'religious' },\n  { word: 'holy mother of god', severity: 'religious' },\n  { word: 'for christ\\'s sake', severity: 'religious' },\n  { word: 'for christs sake', severity: 'religious' },\n  { word: 'chrissake', severity: 'religious' },\n  { word: 'crissake', severity: 'religious' },\n\n  // Severe\n  { word: 'fuck', severity: 'severe' },\n  { word: 'fucking', severity: 'severe' },\n  { word: 'fucked', severity: 'severe' },\n  { word: 'fucker', severity: 'severe' },\n  { word: 'fuckers', severity: 'severe' },\n  { word: 'fucks', severity: 'severe' },\n  { word: 'motherfucker', severity: 'severe' },\n  { word: 'motherfucking', severity: 'severe' },\n  { word: 'motherfuckers', severity: 'severe' },\n  { word: 'cunt', severity: 'severe' },\n  { word: 'cunts', severity: 'severe' },\n  { word: 'nigger', severity: 'severe' },\n  { word: 'niggers', severity: 'severe' },\n  { word: 'nigga', severity: 'severe' },\n  { word: 'niggas', severity: 'severe' },\n  { word: 'faggot', severity: 'severe' },\n  { word: 'faggots', severity: 'severe' },\n  { word: 'fag', severity: 'severe' },\n  { word: 'fags', severity: 'severe' },\n  { word: 'retard', severity: 'severe' },\n  { word: 'retarded', severity: 'severe' },\n  { word: 'retards', severity: 'severe' },\n\n  // Moderate\n  { word: 'shit', severity: 'moderate' },\n  { word: 'shits', severity: 'moderate' },\n  { word: 'shitty', severity: 'moderate' },\n  { word: 'bullshit', severity: 'moderate' },\n  { word: 'horseshit', severity: 'moderate' },\n  { word: 'shithead', severity: 'moderate' },\n  { word: 'shitheads', severity: 'moderate' },\n  { word: 'ass', severity: 'moderate' },\n  { word: 'asses', severity: 'moderate' },\n  { word: 'asshole', severity: 'moderate' },\n  { word: 'assholes', severity: 'moderate' },\n  { word: 'bastard', severity: 'moderate' },\n  { word: 'bastards', severity: 'moderate' },\n  { word: 'bitch', severity: 'moderate' },\n  { word: 'bitches', severity: 'moderate' },\n  { word: 'bitchy', severity: 'moderate' },\n  { word: 'cock', severity: 'moderate' },\n  { word: 'cocks', severity: 'moderate' },\n  { word: 'cocksucker', severity: 'moderate' },\n  { word: 'cocksuckers', severity: 'moderate' },\n  { word: 'dick', severity: 'moderate' },\n  { word: 'dicks', severity: 'moderate' },\n  { word: 'dickhead', severity: 'moderate' },\n  { word: 'dickheads', severity: 'moderate' },\n  { word: 'pussy', severity: 'moderate' },\n  { word: 'pussies', severity: 'moderate' },\n  { word: 'prick', severity: 'moderate' },\n  { word: 'pricks', severity: 'moderate' },\n  { word: 'slut', severity: 'moderate' },\n  { word: 'sluts', severity: 'moderate' },\n  { word: 'slutty', severity: 'moderate' },\n  { word: 'whore', severity: 'moderate' },\n  { word: 'whores', severity: 'moderate' },\n  { word: 'twat', severity: 'moderate' },\n  { word: 'twats', severity: 'moderate' },\n  { word: 'wanker', severity: 'moderate' },\n  { word: 'wankers', severity: 'moderate' },\n  { word: 'bollocks', severity: 'moderate' },\n\n  // Mild\n  { word: 'damn', severity: 'mild' },\n  { word: 'damned', severity: 'mild' },\n  { word: 'dammit', severity: 'mild' },\n  { word: 'damnit', severity: 'mild' },\n  { word: 'hell', severity: 'mild' },\n  { word: 'crap', severity: 'mild' },\n  { word: 'crappy', severity: 'mild' },\n  { word: 'piss', severity: 'mild' },\n  { word: 'pissed', severity: 'mild' },\n  { word: 'pissing', severity: 'mild' },\n  { word: 'suck', severity: 'mild' },\n  { word: 'sucks', severity: 'mild' },\n  { word: 'sucked', severity: 'mild' },\n  { word: 'balls', severity: 'mild' },\n  { word: 'butt', severity: 'mild' },\n  { word: 'butthole', severity: 'mild' },\n  { word: 'screw', severity: 'mild' },\n  { word: 'screwed', severity: 'mild' },\n  { word: 'douche', severity: 'mild' },\n  { word: 'douchebag', severity: 'mild' },\n  { word: 'douchebags', severity: 'mild' },\n];\n\n// Create a Map for O(1) lookup\nexport const PROFANITY_MAP: Map<string, SeverityLevel> = new Map(\n  PROFANITY_LIST.map((item) => [item.word.toLowerCase(), item.severity])\n);\n\n// Safe words that contain profanity substrings but are NOT profane\n// This prevents false positives like \"class\" (contains \"ass\"), \"hello\" (contains \"hell\")\nexport const SAFE_WORDS: Set<string> = new Set([\n  // Words containing \"ass\"\n  'class', 'classes', 'classic', 'classical', 'classics', 'classify', 'classified',\n  'classification', 'classmate', 'classmates', 'classroom', 'classrooms', 'classy',\n  'grass', 'grassy', 'grassland', 'grasshopper',\n  'pass', 'passed', 'passes', 'passing', 'passable', 'passage', 'passages',\n  'passenger', 'passengers', 'passport', 'passports', 'password', 'passwords',\n  'bypass', 'bypassed', 'bypasses', 'bypassing',\n  'compass', 'compasses',\n  'bass', 'bassist', 'bassline',\n  'mass', 'masses', 'massive', 'massively', 'massacre',\n  'brass', 'brassy',\n  'glass', 'glasses', 'glassy', 'glassware',\n  'sass', 'sassy', 'sassafras',\n  'lass', 'lassie', 'lasso',\n  'cassette', 'cassettes', 'casserole',\n  'assassin', 'assassins', 'assassinate', 'assassination',\n  'embassy', 'embassies', 'ambassador', 'ambassadors',\n  'harass', 'harassed', 'harassing', 'harassment',\n  'amass', 'amassed', 'amassing',\n  'morass',\n  'trespass', 'trespassed', 'trespassing', 'trespasser',\n  'carcass', 'carcasses',\n  'canvas', 'canvases', 'canvass', 'canvassed',\n  'molasses',\n  'assume', 'assumed', 'assumes', 'assuming', 'assumption', 'assumptions',\n  'assure', 'assured', 'assures', 'assuring', 'assurance',\n  'assess', 'assessed', 'assesses', 'assessing', 'assessment', 'assessments',\n  'asset', 'assets',\n  'assign', 'assigned', 'assigns', 'assigning', 'assignment', 'assignments',\n  'assist', 'assisted', 'assists', 'assisting', 'assistant', 'assistants', 'assistance',\n  'associate', 'associated', 'associates', 'associating', 'association', 'associations',\n  'assort', 'assorted', 'assortment',\n\n  // Words containing \"hell\"\n  'hello', 'hellos',\n  'shell', 'shells', 'shelled', 'shelling', 'shellfish', 'bombshell',\n  'nutshell', 'eggshell', 'seashell', 'clamshell',\n  'dwell', 'dwells', 'dwelled', 'dwelling', 'dwellings',\n  'swell', 'swells', 'swelled', 'swelling', 'swollen',\n  'well', 'wells', 'wellness', 'farewell', 'stairwell',\n  'spell', 'spells', 'spelled', 'spelling', 'misspell', 'misspelled',\n  'smell', 'smells', 'smelled', 'smelling', 'smelly',\n  'bell', 'bells', 'doorbell', 'bellhop', 'bluebell', 'dumbbell', 'barbell',\n  'cell', 'cells', 'cellular', 'cellar', 'cellars',\n  'fell', 'fella', 'fellas', 'fellow', 'fellows', 'fellowship',\n  'jell', 'jelly', 'jellyfish',\n  'tell', 'tells', 'telling', 'teller', 'storytelling', 'foretell',\n  'sell', 'sells', 'selling', 'seller', 'sellers', 'bestseller', 'bestselling',\n  'yell', 'yells', 'yelled', 'yelling',\n  'propel', 'propelled', 'propeller', 'propelling',\n  'excel', 'excels', 'excelled', 'excelling', 'excellent', 'excellence',\n  'expel', 'expels', 'expelled', 'expelling',\n  'compel', 'compels', 'compelled', 'compelling',\n  'repel', 'repels', 'repelled', 'repelling', 'repellent',\n  'rebellion', 'rebellious', 'rebel', 'rebels', 'rebelled',\n  'hellenic', 'hellenistic',\n\n  // Words containing \"damn\"\n  // Note: \"goddamn\" is NOT here - it IS profanity\n  'amsterdam',\n  'macadam', 'madame', 'madam',\n\n  // Words containing \"cock\"\n  'peacock', 'peacocks',\n  'cockpit', 'cockpits',\n  'cocktail', 'cocktails',\n  'cockatoo', 'cockatoos',\n  'cockerel',\n  'hancock', 'hitchcock', 'babcock', 'woodcock',\n  'stopcock', 'weathercock',\n\n  // Words containing \"dick\"\n  'dickens',\n  'benedict', 'benediction',\n  'predict', 'predicts', 'predicted', 'predicting', 'prediction', 'predictions',\n  'addict', 'addicts', 'addicted', 'addicting', 'addiction', 'addictions', 'addictive',\n  'verdict', 'verdicts',\n  'indict', 'indicts', 'indicted', 'indicting', 'indictment',\n  'contradict', 'contradicts', 'contradicted', 'contradicting', 'contradiction',\n  'dictionary', 'dictionaries', 'diction',\n  'dictate', 'dictates', 'dictated', 'dictating', 'dictation', 'dictator',\n  'edict', 'edicts',\n  'jurisdiction',\n\n  // Words containing \"crap\"\n  'scrap', 'scraps', 'scrapped', 'scrapping', 'scrappy', 'scrapbook', 'scrapyard',\n\n  // Words containing \"piss\"\n  'mississippi',\n\n  // Words containing \"tit\"\n  'title', 'titles', 'titled', 'titling', 'subtitle', 'subtitles', 'subtitled',\n  'entitle', 'entitled', 'entitles', 'entitling', 'entitlement',\n  'constitution', 'constitutional', 'constitutions',\n  'institution', 'institutional', 'institutions',\n  'restitution',\n  'stitute', 'substitute', 'substitutes', 'substituted', 'substitution',\n  'institute', 'institutes', 'instituted', 'institution',\n  'prostitute', 'prostitutes', 'prostitution', // This might be context-dependent\n  'titan', 'titans', 'titanic',\n  'appetite', 'appetites', 'appetizer', 'appetizers',\n  'competition', 'competitions', 'competitive', 'competitor', 'competitors',\n  'petition', 'petitions', 'petitioned', 'petitioning',\n  'repetition', 'repetitions', 'repetitive',\n  'partition', 'partitions', 'partitioned',\n  'quantity', 'quantities', 'quantitative',\n  'identity', 'identities',\n  'entity', 'entities',\n  'utility', 'utilities',\n  'fertility', 'infertility',\n\n  // Words containing \"cum\"\n  'document', 'documents', 'documented', 'documenting', 'documentation', 'documentary',\n  'circumstance', 'circumstances', 'circumstantial',\n  'circumference',\n  'accumulate', 'accumulated', 'accumulates', 'accumulating', 'accumulation',\n  'cucumber', 'cucumbers',\n  'incumbent',\n  'succumb', 'succumbed', 'succumbing',\n\n  // Words containing \"fag\"\n  'faggot', // This IS profanity - keeping for reference\n\n  // Words containing \"sex\" - often legitimate\n  'sextant', 'sextet', 'sextuple',\n\n  // Words containing \"ho\" / \"hoe\"\n  'shoe', 'shoes', 'shoed', 'shoeing', 'horseshoe',\n  'hoe', 'hoes', 'hoeing', // gardening tool\n  'whole', 'wholesome', 'wholesale', 'wholly',\n  'honest', 'honestly', 'honesty', 'dishonest',\n  'honor', 'honors', 'honored', 'honoring', 'honorable', 'honorary', 'dishonor',\n  'hope', 'hopes', 'hoped', 'hoping', 'hopeful', 'hopefully', 'hopeless',\n  'home', 'homes', 'homed', 'homing', 'homeless', 'homemade', 'hometown', 'homework',\n  'horse', 'horses', 'horseback', 'horsepower',\n  'hotel', 'hotels',\n  'horizon', 'horizons', 'horizontal',\n  'hour', 'hours', 'hourly',\n  'house', 'houses', 'housed', 'housing', 'household', 'housewife', 'housekeeper',\n\n  // Words containing \"nig\"\n  'night', 'nights', 'nightly', 'nighttime', 'nightmare', 'nightmares', 'nightclub',\n  'tonight', 'overnight', 'midnight', 'goodnight', 'fortnight',\n  'knight', 'knights', 'knighthood',\n  'ignite', 'ignites', 'ignited', 'igniting', 'ignition',\n  'insignificant', 'significance', 'significant', 'significantly',\n\n  // Words containing \"nud\"\n  'nude', 'nudes', 'nudity', // Context-dependent, usually fine in art/medical context\n\n  // Words containing \"porn\"\n  // Most are actually related to pornography, so no safe words here\n\n  // Words containing \"anal\"\n  'analog', 'analogue', 'analogous', 'analogy', 'analogies',\n  'analysis', 'analyses', 'analyst', 'analysts', 'analytical', 'analyze', 'analyzed',\n  'banal',\n  'canal', 'canals',\n  'final', 'finals', 'finally', 'finalist', 'finalize', 'finalized',\n  'journal', 'journals', 'journalism', 'journalist', 'journalists',\n  'national', 'nationally', 'international', 'internationally',\n  'personal', 'personally', 'personality', 'personalities',\n  'professional', 'professionally', 'professionals',\n  'regional', 'regionally',\n  'original', 'originally', 'originals',\n  'criminal', 'criminally', 'criminals',\n  'terminal', 'terminals',\n  'cardinal', 'cardinals',\n  'signal', 'signals', 'signaled', 'signaling',\n\n  // Words containing \"nut\"\n  'minute', 'minutes', 'minutely',\n  'peanut', 'peanuts',\n  'coconut', 'coconuts',\n  'chestnut', 'chestnuts',\n  'walnut', 'walnuts',\n  'doughnut', 'doughnuts', 'donut', 'donuts',\n  'nutmeg',\n  'nutrition', 'nutritious', 'nutritional', 'nutrient', 'nutrients',\n\n  // Words containing \"god\" (for religious filter)\n  'godfather', 'godfathers', 'godmother', 'godmothers', 'godchild', 'godchildren',\n  'godson', 'godsons', 'goddaughter', 'goddaughters',\n  'godly', 'godliness', 'ungodly',\n  'goddess', 'goddesses',\n  'godspeed',\n  'godsend',\n\n  // Words containing \"lord\" (for religious filter)\n  'landlord', 'landlords', 'landlady',\n  'warlord', 'warlords',\n  'overlord', 'overlords',\n  'lordship',\n\n  // Words containing \"holy\" (for religious filter)\n  'holiday', 'holidays',\n  'wholly',\n\n  // Words containing \"christ\" (for religious filter)\n  'christen', 'christened', 'christening',\n  'christian', 'christians', 'christianity',\n  'christmas', 'christmastime',\n  'christopher',\n\n  // Words containing \"jesus\" (for religious filter)\n  // No common safe words\n\n  // Words containing \"hell\" that are already covered but adding more religious context\n  'hellfire', 'hellbound', // These ARE religious references, not safe words\n]);\n\n// Spelling variations mapping - normalizes common letter substitutions\n// Maps variant characters to their standard letter\nconst CHAR_SUBSTITUTIONS: Record<string, string> = {\n  // Common leetspeak / symbol substitutions\n  '0': 'o',\n  '1': 'i',\n  '3': 'e',\n  '4': 'a',\n  '5': 's',\n  '7': 't',\n  '8': 'b',\n  '@': 'a',\n  '$': 's',\n  '!': 'i',\n  '*': '', // Often used as censoring, remove it\n  '#': '', // Often used as censoring, remove it\n  '+': 't',\n  '(': 'c',\n  '<': 'c',\n  '|': 'i',\n  // Common letter swaps\n  'ph': 'f',\n  'ck': 'k',\n};\n\n// Multi-character substitutions (processed first)\nconst MULTI_CHAR_SUBSTITUTIONS: [string, string][] = [\n  ['ph', 'f'],\n  ['ck', 'k'],\n  ['kk', 'ck'],\n  ['cc', 'ck'],\n  ['xx', 'x'],\n];\n\n/**\n * Normalize a word by replacing common spelling variations with standard letters.\n * This helps detect words like \"f*ck\", \"sh!t\", \"a$$\", \"fvck\", etc.\n */\nexport function normalizeSpelling(text: string): string {\n  let normalized = text.toLowerCase();\n\n  // First, apply multi-character substitutions\n  for (const [from, to] of MULTI_CHAR_SUBSTITUTIONS) {\n    normalized = normalized.split(from).join(to);\n  }\n\n  // Then, apply single character substitutions\n  let result = '';\n  for (const char of normalized) {\n    result += CHAR_SUBSTITUTIONS[char] ?? char;\n  }\n\n  // Remove repeated characters that might be used to evade (e.g., \"fuuuck\" -> \"fuck\")\n  // But be careful not to break legitimate double letters\n  result = result.replace(/(.)\\1{2,}/g, '$1$1'); // Keep max 2 of same char\n\n  return result;\n}\n\n// Get all words of a specific severity\nexport function getWordsBySeverity(severity: SeverityLevel): string[] {\n  return PROFANITY_LIST\n    .filter((item) => item.severity === severity)\n    .map((item) => item.word);\n}\n\n// Check if a word is profanity (also checks normalized spelling)\nexport function isProfanity(word: string): boolean {\n  const lower = word.toLowerCase();\n  if (PROFANITY_MAP.has(lower)) return true;\n\n  // Also check normalized version for spelling variations\n  const normalized = normalizeSpelling(lower);\n  return PROFANITY_MAP.has(normalized);\n}\n\n// Get the severity of a word (also checks normalized spelling)\nexport function getSeverity(word: string): SeverityLevel | null {\n  const lower = word.toLowerCase();\n  const direct = PROFANITY_MAP.get(lower);\n  if (direct) return direct;\n\n  // Also check normalized version for spelling variations\n  const normalized = normalizeSpelling(lower);\n  return PROFANITY_MAP.get(normalized) || null;\n}\n\n// Check if a word is in the safe list (not profane despite containing profanity substring)\nexport function isSafeWord(word: string): boolean {\n  return SAFE_WORDS.has(word.toLowerCase());\n}\n\n// Find profanity within a longer word (e.g., \"fuck\" in \"motherfucker\")\n// Now checks against safe words to avoid false positives\n// Also checks normalized spellings (f*ck, sh!t, etc.)\nexport function findEmbeddedProfanity(\n  text: string\n): { word: string; severity: SeverityLevel; startIndex: number; endIndex: number }[] {\n  const lowerText = text.toLowerCase().trim();\n\n  // First, check if the entire text is a safe word - if so, return no matches\n  if (SAFE_WORDS.has(lowerText)) {\n    return [];\n  }\n\n  const results: {\n    word: string;\n    severity: SeverityLevel;\n    startIndex: number;\n    endIndex: number;\n  }[] = [];\n\n  // Check both original and normalized text\n  const normalizedText = normalizeSpelling(lowerText);\n  const textsToCheck = [lowerText];\n  if (normalizedText !== lowerText) {\n    textsToCheck.push(normalizedText);\n  }\n\n  for (const textToCheck of textsToCheck) {\n    for (const [word, severity] of PROFANITY_MAP) {\n      let index = textToCheck.indexOf(word);\n      while (index !== -1) {\n        // Check if the found substring is actually the whole word (exact match)\n        // or if it's embedded in a safe context\n        const isExactMatch = textToCheck === word;\n        const isWholeWord = (index === 0 || !/[a-z]/.test(textToCheck[index - 1])) &&\n                            (index + word.length === textToCheck.length || !/[a-z]/.test(textToCheck[index + word.length]));\n\n        // Only add if it's an exact match or a whole word within the text\n        // This prevents \"ass\" matching in \"class\" but allows \"ass\" in \"bad-ass\"\n        if (isExactMatch || isWholeWord) {\n          // Use original text indices for timing (approximate for normalized)\n          results.push({\n            word,\n            severity,\n            startIndex: index,\n            endIndex: index + word.length,\n          });\n        }\n\n        index = textToCheck.indexOf(word, index + 1);\n      }\n    }\n  }\n\n  // Sort by start index and remove duplicates (prefer longer matches)\n  results.sort((a, b) => a.startIndex - b.startIndex);\n\n  // Remove overlapping matches, keeping the longer one\n  const filtered: typeof results = [];\n  for (const match of results) {\n    const lastMatch = filtered[filtered.length - 1];\n    if (!lastMatch || match.startIndex >= lastMatch.endIndex) {\n      filtered.push(match);\n    } else if (match.endIndex - match.startIndex > lastMatch.endIndex - lastMatch.startIndex) {\n      filtered[filtered.length - 1] = match;\n    }\n  }\n\n  // Deduplicate by word (in case both original and normalized matched)\n  const seen = new Set<string>();\n  return filtered.filter(match => {\n    const key = `${match.word}-${match.startIndex}`;\n    if (seen.has(key)) return false;\n    seen.add(key);\n    return true;\n  });\n}\n","// SafePlay Popup Script - Clean Redesign\nimport {\n  UserPreferences,\n  DEFAULT_PREFERENCES,\n  FilterMode,\n  SeverityLevel,\n  CreditInfo,\n  AuthState,\n} from '../types';\nimport { PROFANITY_LIST } from '../filter/profanity-list';\nimport './popup.css';\n\nconst THEME_STORAGE_KEY = 'safeplay_theme';\n\nclass PopupController {\n  private preferences: UserPreferences = DEFAULT_PREFERENCES;\n  private creditInfo: CreditInfo | null = null;\n  private authState: AuthState | null = null;\n\n  // Word counts by severity\n  private wordCounts: Record<SeverityLevel, number> = {\n    mild: 0,\n    moderate: 0,\n    severe: 0,\n    religious: 0,\n  };\n\n  // DOM Elements\n  private themeToggle!: HTMLButtonElement;\n  private enableToggle!: HTMLInputElement;\n  private filterModeRadios!: NodeListOf<HTMLInputElement>;\n  private severityMild!: HTMLInputElement;\n  private severityModerate!: HTMLInputElement;\n  private severitySevere!: HTMLInputElement;\n  private severityReligious!: HTMLInputElement;\n  private statusPill!: HTMLElement;\n  private statusLabel!: HTMLElement;\n  private videoStatusSection!: HTMLElement;\n  private videoStatusValue!: HTMLElement;\n  private filteredCount!: HTMLElement;\n  private progressBar!: HTMLElement;\n  private progressFill!: HTMLElement;\n  private totalWordCount!: HTMLElement;\n  private mildCount!: HTMLElement;\n  private moderateCount!: HTMLElement;\n  private severeCount!: HTMLElement;\n  private religiousCount!: HTMLElement;\n\n  // Account elements\n  private accountLoggedOut!: HTMLElement;\n  private accountLoggedIn!: HTMLElement;\n  private signInBtn!: HTMLButtonElement;\n  private signOutBtn!: HTMLButtonElement;\n  private accountAvatar!: HTMLElement;\n  private accountName!: HTMLElement;\n  private accountPlanBadge!: HTMLElement;\n  private accountUpgradeLink!: HTMLAnchorElement;\n  private creditValue!: HTMLElement;\n\n  async initialize(): Promise<void> {\n    // Calculate word counts\n    this.calculateWordCounts();\n\n    // Cache DOM elements\n    this.cacheElements();\n\n    // Load and apply theme\n    this.loadTheme();\n\n    // Display word counts\n    this.displayWordCounts();\n\n    // Load preferences\n    await this.loadPreferences();\n\n    // Set up event listeners\n    this.setupEventListeners();\n\n    // Check current video status\n    await this.checkVideoStatus();\n\n    // Load auth state and user profile\n    await this.loadAuthState();\n\n    // Listen for status updates\n    this.setupMessageListener();\n  }\n\n  private cacheElements(): void {\n    this.themeToggle = document.getElementById('themeToggle') as HTMLButtonElement;\n    this.enableToggle = document.getElementById('enableToggle') as HTMLInputElement;\n    this.filterModeRadios = document.querySelectorAll('input[name=\"filterMode\"]');\n    this.severityMild = document.getElementById('severityMild') as HTMLInputElement;\n    this.severityModerate = document.getElementById('severityModerate') as HTMLInputElement;\n    this.severitySevere = document.getElementById('severitySevere') as HTMLInputElement;\n    this.severityReligious = document.getElementById('severityReligious') as HTMLInputElement;\n    this.statusPill = document.getElementById('statusPill') as HTMLElement;\n    this.statusLabel = document.getElementById('statusLabel') as HTMLElement;\n    this.videoStatusSection = document.getElementById('videoStatus') as HTMLElement;\n    this.videoStatusValue = document.getElementById('videoStatusValue') as HTMLElement;\n    this.filteredCount = document.getElementById('filteredCount') as HTMLElement;\n    this.progressBar = document.getElementById('progressBar') as HTMLElement;\n    this.progressFill = document.getElementById('progressFill') as HTMLElement;\n    this.totalWordCount = document.getElementById('totalWordCount') as HTMLElement;\n    this.mildCount = document.getElementById('mildCount') as HTMLElement;\n    this.moderateCount = document.getElementById('moderateCount') as HTMLElement;\n    this.severeCount = document.getElementById('severeCount') as HTMLElement;\n    this.religiousCount = document.getElementById('religiousCount') as HTMLElement;\n\n    // Account elements\n    this.accountLoggedOut = document.getElementById('accountLoggedOut') as HTMLElement;\n    this.accountLoggedIn = document.getElementById('accountLoggedIn') as HTMLElement;\n    this.signInBtn = document.getElementById('signInBtn') as HTMLButtonElement;\n    this.signOutBtn = document.getElementById('signOutBtn') as HTMLButtonElement;\n    this.accountAvatar = document.getElementById('accountAvatar') as HTMLElement;\n    this.accountName = document.getElementById('accountName') as HTMLElement;\n    this.accountPlanBadge = document.getElementById('accountPlanBadge') as HTMLElement;\n    this.accountUpgradeLink = document.getElementById('accountUpgradeLink') as HTMLAnchorElement;\n    this.creditValue = document.getElementById('creditValue') as HTMLElement;\n  }\n\n  private loadTheme(): void {\n    const savedTheme = localStorage.getItem(THEME_STORAGE_KEY);\n    if (savedTheme === 'light') {\n      document.body.classList.add('light-theme');\n    }\n  }\n\n  private toggleTheme(): void {\n    const isLight = document.body.classList.toggle('light-theme');\n    localStorage.setItem(THEME_STORAGE_KEY, isLight ? 'light' : 'dark');\n  }\n\n  private async loadCredits(): Promise<void> {\n    if (!this.authState?.isAuthenticated) {\n      this.creditValue.textContent = '0';\n      return;\n    }\n\n    try {\n      const response = await chrome.runtime.sendMessage({ type: 'GET_CREDITS' });\n\n      if (response.success && response.data) {\n        this.creditInfo = response.data;\n        this.displayCredits();\n      }\n    } catch (error) {\n      console.error('Failed to load credits:', error);\n    }\n  }\n\n  private displayCredits(): void {\n    if (!this.creditInfo) return;\n\n    const { available, used_this_period, plan_allocation } = this.creditInfo;\n\n    // Update credit value\n    this.creditValue.textContent = available.toString();\n    this.creditValue.classList.remove('low', 'empty');\n\n    // Calculate remaining base credits\n    const baseRemaining = Math.max(0, plan_allocation - used_this_period);\n    const bonusRemaining = Math.max(0, available - baseRemaining);\n\n    if (available === 0) {\n      this.creditValue.classList.add('empty');\n    } else if (baseRemaining === 0 && bonusRemaining <= 5) {\n      this.creditValue.classList.add('low');\n    }\n  }\n\n  private calculateWordCounts(): void {\n    for (const item of PROFANITY_LIST) {\n      this.wordCounts[item.severity]++;\n    }\n  }\n\n  private displayWordCounts(): void {\n    this.mildCount.textContent = this.wordCounts.mild.toString();\n    this.moderateCount.textContent = this.wordCounts.moderate.toString();\n    this.severeCount.textContent = this.wordCounts.severe.toString();\n    this.religiousCount.textContent = this.wordCounts.religious.toString();\n\n    this.updateTotalWordCount();\n  }\n\n  private updateTotalWordCount(): void {\n    let total = 0;\n    if (this.severityMild?.checked) total += this.wordCounts.mild;\n    if (this.severityModerate?.checked) total += this.wordCounts.moderate;\n    if (this.severitySevere?.checked) total += this.wordCounts.severe;\n    if (this.severityReligious?.checked) total += this.wordCounts.religious;\n\n    total += this.preferences.customBlacklist.length;\n\n    this.totalWordCount.textContent = `${total} words`;\n  }\n\n  private async loadPreferences(): Promise<void> {\n    try {\n      const response = await chrome.runtime.sendMessage({ type: 'GET_PREFERENCES' });\n      if (response.success && response.data) {\n        this.preferences = response.data;\n        this.updateUI();\n      }\n    } catch (error) {\n      console.error('Failed to load preferences:', error);\n    }\n  }\n\n  private updateUI(): void {\n    // Update toggle\n    this.enableToggle.checked = this.preferences.enabled;\n    document.body.classList.toggle('disabled', !this.preferences.enabled);\n\n    // Update status pill\n    this.updateStatusPill();\n\n    // Update filter mode\n    this.filterModeRadios.forEach((radio) => {\n      radio.checked = radio.value === this.preferences.filterMode;\n    });\n\n    // Update severity checkboxes\n    this.severityMild.checked = this.preferences.severityLevels.mild;\n    this.severityModerate.checked = this.preferences.severityLevels.moderate;\n    this.severitySevere.checked = this.preferences.severityLevels.severe;\n    this.severityReligious.checked = this.preferences.severityLevels.religious;\n\n    // Update total word count\n    this.updateTotalWordCount();\n  }\n\n  private updateStatusPill(): void {\n    this.statusPill.classList.remove('inactive', 'error', 'warning');\n\n    if (!this.preferences.enabled) {\n      this.statusPill.classList.add('inactive');\n      this.statusLabel.textContent = 'Disabled';\n    } else {\n      this.statusLabel.textContent = 'Active';\n    }\n  }\n\n  private setupEventListeners(): void {\n    // Theme toggle\n    this.themeToggle.addEventListener('click', () => {\n      this.toggleTheme();\n    });\n\n    // Enable toggle\n    this.enableToggle.addEventListener('change', () => {\n      this.savePreferences({ enabled: this.enableToggle.checked });\n    });\n\n    // Filter mode\n    this.filterModeRadios.forEach((radio) => {\n      radio.addEventListener('change', () => {\n        if (radio.checked) {\n          this.savePreferences({ filterMode: radio.value as FilterMode });\n        }\n      });\n    });\n\n    // Severity levels\n    const severityHandler = () => {\n      this.saveSeverityLevels();\n      this.updateTotalWordCount();\n    };\n\n    this.severityMild.addEventListener('change', severityHandler);\n    this.severityModerate.addEventListener('change', severityHandler);\n    this.severitySevere.addEventListener('change', severityHandler);\n    this.severityReligious.addEventListener('change', severityHandler);\n\n    // Account listeners\n    this.signInBtn?.addEventListener('click', () => this.handleSignIn());\n    this.signOutBtn?.addEventListener('click', () => this.handleSignOut());\n\n    // Settings link\n    const settingsLink = document.getElementById('settingsLink');\n    settingsLink?.addEventListener('click', (e) => {\n      e.preventDefault();\n      chrome.runtime.openOptionsPage?.();\n    });\n  }\n\n  private saveSeverityLevels(): void {\n    this.savePreferences({\n      severityLevels: {\n        mild: this.severityMild.checked,\n        moderate: this.severityModerate.checked,\n        severe: this.severitySevere.checked,\n        religious: this.severityReligious.checked,\n      },\n    });\n  }\n\n  private async savePreferences(updates: Partial<UserPreferences>): Promise<void> {\n    try {\n      const response = await chrome.runtime.sendMessage({\n        type: 'SET_PREFERENCES',\n        payload: updates,\n      });\n\n      if (response.success && response.data) {\n        this.preferences = response.data;\n        this.updateUI();\n      }\n    } catch (error) {\n      console.error('Failed to save preferences:', error);\n    }\n  }\n\n  private async checkVideoStatus(): Promise<void> {\n    try {\n      const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n\n      if (!tab?.id || !tab.url?.includes('youtube.com/watch')) {\n        this.videoStatusSection.style.display = 'none';\n        return;\n      }\n\n      const response = await chrome.tabs.sendMessage(tab.id, { type: 'GET_VIDEO_STATE' });\n\n      if (response?.success && response.data) {\n        this.updateVideoStatus(response.data);\n      }\n    } catch (error) {\n      this.videoStatusSection.style.display = 'none';\n    }\n  }\n\n  private updateVideoStatus(state: {\n    status: string;\n    progress: number;\n    error?: string;\n    intervalCount: number;\n    currentlyMuting: boolean;\n  }): void {\n    this.videoStatusSection.style.display = 'block';\n\n    const statusMap: Record<string, string> = {\n      idle: 'Ready',\n      loading: 'Loading',\n      processing: 'Processing',\n      active: 'Filtering',\n      error: 'Error',\n      disabled: 'Disabled',\n      'age-restricted': 'Restricted',\n    };\n\n    this.videoStatusValue.textContent = statusMap[state.status] || state.status;\n\n    // Update status pill for special states\n    this.statusPill.classList.remove('error', 'warning');\n\n    if (state.status === 'age-restricted') {\n      this.statusPill.classList.add('warning');\n      this.statusLabel.textContent = 'Restricted';\n    } else if (state.status === 'error') {\n      this.statusPill.classList.add('error');\n      this.statusLabel.textContent = 'Error';\n    }\n\n    // Update filtered count\n    this.filteredCount.textContent = state.intervalCount.toString();\n\n    // Update progress bar\n    if (state.status === 'processing') {\n      this.progressBar.style.display = 'block';\n      this.progressFill.style.width = `${state.progress}%`;\n    } else {\n      this.progressBar.style.display = 'none';\n    }\n  }\n\n  private setupMessageListener(): void {\n    chrome.runtime.onMessage.addListener((message) => {\n      if (message.type === 'VIDEO_STATE_CHANGED' && message.payload) {\n        this.updateVideoStatus(message.payload);\n      }\n      if (message.type === 'PREFERENCES_UPDATED' && message.payload) {\n        this.preferences = message.payload;\n        this.updateUI();\n      }\n      if (message.type === 'CREDIT_UPDATE' && message.payload) {\n        this.creditInfo = message.payload;\n        this.displayCredits();\n      }\n      if (message.type === 'AUTH_STATE_CHANGED' && message.payload) {\n        this.loadAuthState();\n      }\n    });\n  }\n\n  private async loadAuthState(): Promise<void> {\n    try {\n      const response = await chrome.runtime.sendMessage({ type: 'GET_USER_PROFILE' });\n\n      if (response.success && response.data) {\n        this.authState = response.data;\n        this.updateAccountUI();\n\n        if (this.authState?.isAuthenticated) {\n          await this.loadCredits();\n        }\n      } else {\n        this.authState = {\n          isAuthenticated: false,\n          user: null,\n          subscription: null,\n          credits: null,\n          token: null,\n        };\n        this.updateAccountUI();\n      }\n    } catch (error) {\n      console.error('Failed to load auth state:', error);\n      this.authState = {\n        isAuthenticated: false,\n        user: null,\n        subscription: null,\n        credits: null,\n        token: null,\n      };\n      this.updateAccountUI();\n    }\n  }\n\n  private updateAccountUI(): void {\n    if (!this.authState) return;\n\n    if (this.authState.isAuthenticated && this.authState.user) {\n      // Show logged in state\n      this.accountLoggedOut.style.display = 'none';\n      this.accountLoggedIn.style.display = 'flex';\n\n      const user = this.authState.user;\n      this.accountName.textContent = user.full_name || user.email?.split('@')[0] || 'User';\n\n      // Update avatar\n      if (user.avatar_url) {\n        this.accountAvatar.innerHTML = `<img src=\"${this.escapeHtml(user.avatar_url)}\" alt=\"Avatar\">`;\n      } else {\n        this.accountAvatar.innerHTML = `\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/>\n            <circle cx=\"12\" cy=\"7\" r=\"4\"/>\n          </svg>\n        `;\n      }\n\n      // Update plan badge\n      const subscription = this.authState.subscription;\n      const planName = subscription?.plans?.name || 'Free';\n      const planId = planName.toLowerCase();\n      this.accountPlanBadge.textContent = planName;\n      this.accountPlanBadge.className = `account-plan ${planId}`;\n\n      // Hide upgrade link for unlimited plans\n      if (planId === 'unlimited' || planId === 'organization') {\n        this.accountUpgradeLink.style.display = 'none';\n      } else {\n        this.accountUpgradeLink.style.display = 'flex';\n      }\n    } else {\n      // Show logged out state\n      this.accountLoggedOut.style.display = 'flex';\n      this.accountLoggedIn.style.display = 'none';\n      this.creditValue.textContent = '0';\n    }\n  }\n\n  private escapeHtml(text: string): string {\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  private async handleSignIn(): Promise<void> {\n    try {\n      await chrome.runtime.sendMessage({ type: 'OPEN_LOGIN' });\n      window.close();\n    } catch (error) {\n      console.error('Failed to open login:', error);\n    }\n  }\n\n  private async handleSignOut(): Promise<void> {\n    try {\n      await chrome.runtime.sendMessage({ type: 'LOGOUT' });\n\n      this.authState = {\n        isAuthenticated: false,\n        user: null,\n        subscription: null,\n        credits: null,\n        token: null,\n      };\n      this.creditInfo = null;\n\n      this.updateAccountUI();\n    } catch (error) {\n      console.error('Failed to sign out:', error);\n    }\n  }\n}\n\n// Initialize when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  const popup = new PopupController();\n  popup.initialize();\n});\n"],"names":["DEFAULT_PREFERENCES","enabled","filterMode","severityLevels","mild","moderate","severe","religious","customBlacklist","customWhitelist","paddingMs","paddingBeforeMs","paddingAfterMs","mergeThresholdMs","autoEnableForFilteredVideos","PROFANITY_LIST","word","severity","Map","map","item","toLowerCase","Set","THEME_STORAGE_KEY","PopupController","preferences","creditInfo","authState","wordCounts","initialize","this","calculateWordCounts","cacheElements","loadTheme","displayWordCounts","loadPreferences","setupEventListeners","checkVideoStatus","loadAuthState","setupMessageListener","themeToggle","document","getElementById","enableToggle","filterModeRadios","querySelectorAll","severityMild","severityModerate","severitySevere","severityReligious","statusPill","statusLabel","videoStatusSection","videoStatusValue","filteredCount","progressBar","progressFill","totalWordCount","mildCount","moderateCount","severeCount","religiousCount","accountLoggedOut","accountLoggedIn","signInBtn","signOutBtn","accountAvatar","accountName","accountPlanBadge","accountUpgradeLink","creditValue","localStorage","getItem","body","classList","add","toggleTheme","isLight","toggle","setItem","loadCredits","isAuthenticated","response","chrome","runtime","sendMessage","type","success","data","displayCredits","error","console","textContent","available","used_this_period","plan_allocation","toString","remove","baseRemaining","Math","max","bonusRemaining","updateTotalWordCount","total","checked","length","updateUI","updateStatusPill","forEach","radio","value","addEventListener","savePreferences","severityHandler","saveSeverityLevels","handleSignIn","handleSignOut","settingsLink","e","preventDefault","openOptionsPage","updates","payload","tab","tabs","query","active","currentWindow","id","url","includes","style","display","updateVideoStatus","state","idle","loading","processing","disabled","status","intervalCount","width","progress","onMessage","addListener","message","updateAccountUI","user","subscription","credits","token","full_name","email","split","avatar_url","innerHTML","escapeHtml","planName","plans","name","planId","className","text","div","createElement","window","close"],"ignoreList":[],"sourceRoot":""}